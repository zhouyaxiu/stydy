import{E as e,F as a,G as l,H as t}from"./gjdc.b3af9cfa.js";import{m as s}from"./index.143fdacc.js";import{r as o,j as r,S as i,b as u,c as n,e as d,k as p,w as c,f as m,A as v,U as b,I as g,Y as h,d as f,u as y}from"./vendor.cc783c3b.js";const C={key:0,style:{position:"absolute",top:"92px",right:"40px"}},D={style:{margin:"-16px"}},T={__name:"dialogInfo",props:{visible:{type:Boolean,default:!1},searchData:{type:Object,default:{}}},emits:["close"],setup(l,{emit:t}){const s=l,{appContext:f}=h(),y=f.config.globalProperties,T=o([]),N=o(0),S=o(0),x=o(!1),I=r([{label:"序号",minWidth:"60",type:"index"},{label:"地市编码",prop:"cityCode",minWidth:"100"},{label:"地市名称",prop:"cityName",minWidth:"100"},{label:"县区编码",prop:"countyCode",minWidth:"100"},{label:"县区名称",prop:"countyName",minWidth:"100"},{label:"单位编码",prop:"fstationCode",minWidth:"100"},{label:"单位名称",prop:"fstationName",minWidth:"100"},{label:"受种者编码",prop:"fchildno",minWidth:"130"},{label:"姓名",prop:"name"},{label:"性别",prop:"sex"},{label:"出生日期",prop:"birth"},{label:"身份证件号码",prop:"cid"},{label:"错误描述（message）",prop:"errorDesc",minWidth:"180"}]),k=a=>{"number"==typeof a&&(S.value=a);const l={areaCode:s.searchData.areaCode,areaId:s.searchData.areaId,areaLevel:s.searchData.areaLevel,areaName:s.searchData.areaName,childCount:s.searchData.childCount,endTime:s.searchData.endTime,message:s.searchData.messageType,pageNum:S.value,pageSize:y.$consts.PAGE_SIZE,startTime:s.searchData.startTime,status:s.searchData.status};e(l).then((e=>{200===e.data.code&&(T.value=e.data.data.list,N.value=e.data.data.total)}))};i((()=>s.visible),(e=>{e&&k()}),{deep:!0,immediate:!0});const V=()=>{t("close",!0)},_=()=>s.searchData?T.value&&0==T.value.length?y.$util.showMsg("暂无需要导出的数据！","error",5e3,!0):void(x.value=!0):y.$util.showMsg("查询后才可以导出！","error",5e3,!0),w=()=>{let e=JSON.parse(JSON.stringify(searchData.value));e.operateType=y.$consts.OPTYPE_OUTPUT,a(e)},L=()=>{x.value=!1};return(e,a)=>{const t=u("ss-pagination"),s=u("ss-custom-button"),o=u("ss-custom-table"),r=u("el-dialog"),i=u("ss-export-dialog");return n(),d(g,null,[p(r,{title:"国家数据上传错误统计表详细",modelValue:l.visible,"onUpdate:modelValue":a[0]||(a[0]=e=>b(visible)?visible.value=e:null),width:"1200","before-close":V,"close-on-click-modal":!1,class:"userManageFormDialog","append-to-body":!0},{default:c((()=>[p(t,{total:N.value,pageIndex:S.value,pageSize:e.pageSize,onPageChange:k},null,8,["total","pageIndex","pageSize"]),N.value?(n(),d("div",C,[p(s,{type:"output",onClick:_})])):m("",!0),v("div",D,[p(o,{tableData:T.value,columnList:I},null,8,["tableData","columnList"])])])),_:1},8,["modelValue"]),p(i,{onCallback:w,onHandleClose:L,total:N.value,typeStr:"未上传接种单位统计",dialogVisible:x.value},null,8,["total","dialogVisible"])],64)}}},N={class:"condition-row"},S={class:"item"},x=v("span",{class:"label required"},"上传日期：",-1),I={class:"item"},k=v("span",{class:"required label"},"选择地区：",-1),V={__name:"index",setup(e){const a=s(),i=o([]),g=o(0),C=o(1),D=o(0),V=o(!1),_=r([{label:"序号",prop:"id"},{label:"错误编码",prop:"status"},{label:"错误描述",prop:"message"},{label:"数量",prop:"totalCount",type:"clickable"}]),w=o(null),L=o(null),{appContext:P}=h(),$=P.config.globalProperties,O=o([$.$dateUtil.dayAddNum(1),$.$dateUtil.dayAddNum(1)]),U=o(null);let W=r({areaId:a.userInfo.areaId,areaCode:a.userInfo.areaCode,areaName:a.userInfo.areaName,selectAreaLevel:sessionStorage.getItem("currentLevel")});const A=e=>{"number"==typeof e&&(C.value=e);let a=O.value[0],l=O.value[1];if(!a||!l)return $.$util.showMsg("请选择日期范围！","error",5e3,!0);const s={areaCode:W.areaCode,areaId:W.areaId,areaLevel:W.selectAreaLevel,areaName:W.areaName,endTime:l,startTime:a,pageNum:C.value,pageSize:$.$consts.PAGE_SIZE};w.value=s,t(s).then((e=>{200===e.data.code&&(i.value=e.data.data.list,g.value=e.data.data.total,D.value=e.data.sec)}))},E=e=>{W=e},j=()=>w.value&&w.value.areaCode==W.areaCode?i.value&&0==i.value.length?$.$util.showMsg("暂无需要导出的数据！","error",5e3,!0):void(L.value=!0):$.$util.showMsg("查询后才可以导出！","error",5e3,!0),M=()=>{let e=JSON.parse(JSON.stringify(w.value));e.operateType=$.$consts.OPTYPE_OUTPUT,l(e)},z=()=>{L.value=!1},q=e=>{let a=i.value.filter((a=>a.id==e))[0];w.message=a.message,w.status=a.status,w.totalCount=a.totalCount,w.id=a.id,V.value=!0},J=()=>{V.value=!1};return(e,a)=>{const l=u("ss-date-range-new"),t=u("ss-area-areaTreeStation"),s=u("ss-custom-button"),o=u("ss-query-bottom"),r=u("ss-condition-area"),h=u("ss-custom-table"),C=u("ss-export-dialog");return n(),d("div",null,[p(r,null,{default:c((()=>[v("div",N,[v("div",S,[x,p(l,{ref_key:"daterangeRef",ref:U,defaultValue:O.value,"onUpdate:defaultValue":a[0]||(a[0]=e=>O.value=e),rangeName:"weeks"},null,8,["defaultValue"])]),v("div",I,[k,p(t,{ref:"areaTreeStation",modelValue:y(W),"onUpdate:modelValue":a[1]||(a[1]=e=>b(W)?W.value=e:W=e),getToLevelNum:5,showSelect:!1,onNodeClick:E},null,8,["modelValue"])])]),p(o,{tipText:"国家上传错误数据按归属单位统计。",secTime:D.value},{default:c((()=>[p(s,{type:"query",onClick:A}),p(s,{type:"output",onClick:j})])),_:1},8,["secTime"])])),_:1}),p(h,{tableData:i.value,columnList:_,onOpenDetailDialog:q,total:g.value,remarkText:"1、系统当天的数据，在17点进行汇总，汇总上传时间截止到16点前的更新个案情况。同时更新前一天上传档案对应的上传成功档案数、上传失败档案数、国家无返回档案数。<br>2、系统非当天的数据，在第2天凌晨进行汇总。"},null,8,["tableData","columnList","total"]),V.value?(n(),f(T,{key:0,visible:V.value,onClose:J,searchData:w.value},null,8,["visible","searchData"])):m("",!0),p(C,{onCallback:M,onHandleClose:z,total:g.value,typeStr:"未上传接种单位统计",dialogVisible:L.value},null,8,["total","dialogVisible"])])}}};export{V as default};
