var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,r=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,s=(e,a)=>{for(var l in a||(a={}))o.call(a,l)&&r(e,l,a[l]);if(t)for(var l of t(a))i.call(a,l)&&r(e,l,a[l]);return e},n=(e,t)=>a(e,l(t));import{u,v as d,w as p,x as c}from"./gjdc.b3af9cfa.js";import{g as v}from"./area.ee098c38.js";import{r as m,j as b,S as f,b as h,c as g,e as w,k as y,w as C,f as N,A as T,U as V,I as j,Y as k,Z as x,o as W,d as D,u as O,J as S,B as P}from"./vendor.cc783c3b.js";import{p as U}from"./regex.fcd5bf03.js";import{m as _}from"./index.143fdacc.js";const L={key:0,style:{position:"absolute",top:"92px",right:"40px"}},M={style:{margin:"-16px"}},q={__name:"dialogInfo",props:{visible:{type:Boolean,default:!1},detailData:{type:Object,default:{}},detailOtherData:{type:Object,default:{}}},emits:["close"],setup(e,{emit:a}){const l=e,{appContext:t}=k(),o=t.config.globalProperties,i=m([]),r=m(0),p=m("1"),c=m(20),v=m(!1),x=b([{label:"序号",type:"index",minWidth:"80"},{label:"姓名",prop:"name",minWidth:"140",overflowTip:!0},{label:"性别",prop:"sex",minWidth:"80"},{label:"出生日期",prop:"birth",minWidth:"100"},{label:"身份证件号码",prop:"cid",minWidth:"150",overflowTip:!0},{label:"现居住地",prop:"addr",minWidth:"160",overflowTip:!0},{label:"居委会",prop:"jwh",minWidth:"120",overflowTip:!0},{label:"工作单位",prop:"fchildUnitName",minWidth:"120",overflowTip:!0},{label:"人群分类",prop:"fcrowdKindName",minWidth:"120",overflowTip:!0},{label:"联系电话",prop:"mobPhone",minWidth:"120"},{label:"第1剂次",hasChildrenTitle:!0,list:[{label:"接种日期",prop:"jzrq1",minWidth:"100"},{label:"接种人员",prop:"jzys1",minWidth:"100",overflowTip:!0},{label:"接种单位",prop:"fstationName1",minWidth:"160",overflowTip:!0}]},{label:"第2剂次",hasChildrenTitle:!0,list:[{label:"接种日期",prop:"jzrq2",minWidth:"100"},{label:"接种人员",prop:"jzys2",minWidth:"100",overflowTip:!0},{label:"接种单位",prop:"fstationName2",minWidth:"160",overflowTip:!0}]},{label:"第3剂次",hasChildrenTitle:!0,list:[{label:"接种日期",prop:"jzrq3",minWidth:"100"},{label:"接种人员",prop:"jzys3",minWidth:"100",overflowTip:!0},{label:"接种单位",prop:"fstationName3",minWidth:"160",overflowTip:!0}]}]),W=e=>{"number"==typeof e&&(p.value=e);const a=n(s({},l.detailData),{pageIndex:p.value});u(a).then((e=>{if(200!=e.data.code)return i.value=[],r.value=0,o.$util.showMsg(e.data.popMsg,"error",5e3,!0);i.value=e.data.data.data.list,r.value=e.data.data.data.total}))};f((()=>l.visible),(e=>{e&&W()}),{deep:!0,immediate:!0});const D=()=>{a("close",!0)},O=()=>{v.value=!0},S=e=>{let a=n(s({},l.detailData),{pageIndex:e,operateType:o.$consts.OPTYPE_OUTPUT});d(a)},P=()=>{v.value=!1};return(a,l)=>{const t=h("ss-pagination"),o=h("ss-custom-button"),s=h("ss-custom-table"),n=h("el-dialog"),u=h("ss-export-dialog");return g(),w(j,null,[y(n,{title:"新冠病毒疫苗到期未种统计表详情",modelValue:e.visible,"onUpdate:modelValue":l[0]||(l[0]=e=>V(visible)?visible.value=e:null),width:"1200","before-close":D,"close-on-click-modal":!1,class:"userManageFormDialog","append-to-body":!0},{default:C((()=>[y(t,{total:r.value,pageIndex:p.value,pageSize:c.value,onPageChange:W},null,8,["total","pageIndex","pageSize"]),r.value?(g(),w("div",L,[y(o,{type:"output",onClick:O})])):N("",!0),T("div",M,[y(s,{tableData:i.value,columnList:x},null,8,["tableData","columnList"])])])),_:1},8,["modelValue"]),y(u,{onCallback:S,onHandleClose:P,total:r.value,typeStr:"新冠病毒疫苗到期未种统计表详情导出",dialogVisible:v.value},null,8,["total","dialogVisible"])],64)}}};const z={class:"wz"},I={class:"condition-row"},$={class:"item"},Y=T("span",{class:"label required"},"地区：",-1),A={class:"item"},B=T("span",{class:"label required"},"应种日期：",-1),E={class:"item"},J=T("span",{class:"label required"},"出生日期：",-1),F={class:"condition-row"},G={class:"item"},H=T("span",{class:"label required"},"接种间隔（天）：",-1),K={class:"item"},Z=T("span",{class:"label"},"疫苗生产企业：",-1),Q={class:"item"},R=T("span",{class:"label required"},"制品编码：",-1),X={class:"item"},ee=T("span",{class:"label required"},"未种剂次：",-1),ae={key:0},le=["onClick"],te={__name:"index",setup(e){const{appContext:a}=k(),l=a.config.globalProperties,t=_(),o=m([]),i=m(0),r=m(null),u=m(!1),d=m([l.$dateUtil.dayAddNum(7),l.$dateUtil.currentDate()]),L=m([x().add(-1,"month").format("YYYY-MM-DD"),l.$dateUtil.currentDate()]),M=m(""),te=m(""),oe=m(null),ie=m(null),re=[{id:"",name:"请选择"},{id:"2",name:"第2剂次"},{id:"3",name:"第3剂次"},{id:"4",name:"第4剂次"}],se=m(re);f((()=>ie&&ie.value&&ie.value.vaccNo),(e=>{se.value="G3"==e?re.filter((e=>"4"!=e.id)):re,te.value=""}),{deep:!1,immediate:!1});const ne=m(null);let ue=b({areaCode:t.userInfo.areaCode,selectAreaLevel:sessionStorage.getItem("currentLevel"),skipValue:String(Number(sessionStorage.getItem("currentLevel"))+1),areaName:t.userInfo.areaName});const de=()=>{let e=d.value[0],a=d.value[1];if(!e||!a)return l.$util.showMsg("请选择应种日期范围！","error",5e3,!0);let t=L.value[0],r=L.value[1];if(!U.test(M.value))return l.$util.showMsg("接种间隔（天）必须是大于0的正整数","error",5e3,!0);if(!te.value)return l.$util.showMsg("请选择一个剂次","error",5e3,!0);const u={areaCode:ue.areaCode,areaLevel:ue.selectAreaLevel,showLevel:"5"==ue.skipValue?4:ue.skipValue,startYzDate:e,endYzDate:a,startBirthDate:t,endBirthDate:r,day:M.value,fenterNo:oe.value.fenterNo,vaccNo:ie.value.vaccNo,jici:te.value};let c=te.value?se.value.filter((e=>e.id==te.value))[0].name:"",v=oe.value.fenterNo?oe.value.fenterName:"",m=ie.value.vaccNo?ie.value.vaccName:"";ne.value=n(s({},u),{areaName:ue.areaName+ue.areaCode.slice(0,10),vaccName:m,fenterName:v,jiciName:c}),p(u).then((e=>{200===e.data.code?(o.value=e.data.data.data,i.value=e.data.data.sec):e.data.popMsg&&(i.value="",o.value=[],l.$util.showMsg(e.data.popMsg,"error"))}))},pe=e=>{ue=e,ue.skipValue=String(Number(ue.selectAreaLevel)+1)},ce=e=>{ue.skipValue=e},ve=()=>{if(!ne.value||ne.value.areaCode!=ue.areaCode)return l.$util.showMsg("查询后才可以导出！","error",5e3,!0);let e=JSON.parse(JSON.stringify(ne.value));e.operateType=l.$consts.OPTYPE_OUTPUT,c(e)},me=()=>{u.value=!1};return W((()=>{})),(e,a)=>{const l=h("ss-area-areaTreeStation"),t=h("ss-date-range-new"),p=h("el-input"),c=h("ss-vaccine-vendor"),m=h("ss-product-code"),b=h("el-option"),f=h("el-select"),k=h("ss-custom-button"),x=h("ss-query-bottom"),W=h("ss-condition-area"),U=h("el-table-column"),_=h("ss-table");return g(),w("div",z,[y(W,null,{default:C((()=>[T("div",I,[T("div",$,[Y,y(l,{modelValue:O(ue),"onUpdate:modelValue":a[0]||(a[0]=e=>V(ue)?ue.value=e:ue=e),getToLevelNum:5,showSelect:!0,onNodeClick:pe,onSelectClick:ce},null,8,["modelValue"])]),T("div",A,[B,y(t,{defaultValue:d.value,"onUpdate:defaultValue":a[1]||(a[1]=e=>d.value=e)},null,8,["defaultValue"])]),T("div",E,[J,y(t,{defaultValue:L.value,"onUpdate:defaultValue":a[2]||(a[2]=e=>L.value=e)},null,8,["defaultValue"])])]),T("div",F,[T("div",G,[H,y(p,{modelValue:M.value,"onUpdate:modelValue":a[3]||(a[3]=e=>M.value=e),clearable:"",maxlength:"9"},null,8,["modelValue"])]),T("div",K,[Z,y(c,{ref_key:"selectedVaccineVendor",ref:oe},null,512)]),T("div",Q,[R,y(m,{ref_key:"selectedVaccNo",ref:ie},null,512)]),T("div",X,[ee,y(f,{modelValue:te.value,"onUpdate:modelValue":a[4]||(a[4]=e=>te.value=e),placeholder:"请选择",clearable:"",style:{position:"relative"}},{default:C((()=>[(g(!0),w(j,null,S(se.value,(e=>(g(),D(b,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])]),y(x,{statisTics:!0,secTime:i.value},{default:C((()=>[y(k,{type:"query",onClick:de}),y(k,{type:"output",onClick:ve})])),_:1},8,["secTime"])])),_:1}),y(_,{data:o.value,headerCellStyle:{"text-align":"center"},cellStyle:{"text-align":"center"}},{default:C((()=>[y(U,{"min-width":"60",label:"地区"},{default:C((e=>[T("span",null,P(e.row.areaCode.slice(0,10))+"  "+P(e.row.areaName),1)])),_:1}),y(U,{label:"人数",prop:"count"},{default:C((e=>[0==e.row.count?(g(),w("span",ae,P(e.row.count),1)):(g(),w("span",{key:1,onClick:a=>{return l=e.row,r.value=n(s({},ne.value),{areaCode:"合计"!=l.areaCode?l.areaCode:ue.areaCode,areaLevel:"合计"!=l.areaCode?v(l.areaCode):ue.selectAreaLevel,showLevel:""}),void(u.value=!0);var l},style:{color:"#2c6aff",cursor:"pointer"}},P(e.row.count),9,le))])),_:1})])),_:1},8,["data"]),u.value?(g(),D(q,{key:0,visible:u.value,onClose:me,detailData:r.value},null,8,["visible","detailData"])):N("",!0)])}}};export{te as default};
