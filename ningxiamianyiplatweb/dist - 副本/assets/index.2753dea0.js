import{m as e,q as a,b as l}from"./index.143fdacc.js";import{q as t}from"./setting.2fd48f52.js";import{Y as u,r as d,j as o,S as i,o as s,b as n,c as r,e as m,k as v,w as p,n as c,A as b,I as f,J as g,d as h,l as V,B as y}from"./vendor.cc783c3b.js";const I={class:"condition-row"},_={class:"item required"},N={class:"item"},Y=b("span",{class:"label required"},"操作类型：",-1),w={class:"condition-row"},x={class:"item"},D={class:"item"},U={class:"condition-row"},k={__name:"index",setup(k){const M=e(),{appContext:S}=u(),j=S.config.globalProperties,q=d(["登录","增加","修改","删除","查询","","导出"]),P=d(!1),C=d(!1),H=d([]),T=o({moduleId:"",userId:"",type:[],startDate:"",endDate:"",pageNum:0}),$=d(null),J=d(null),O=d(0),z=d(1),A=d(20),E=d([]),F=d([]),B=d([]),Q=d([]),R=d([{id:"0",value:"登录"},{id:"1",value:"增加"},{id:"2",value:"修改"},{id:"3",value:"删除"},{id:"4",value:"查询"},{id:"6",value:"导出"}]);i((()=>P),(()=>{T.userId=""}),{deep:!0,immediate:!0}),i((()=>C),(()=>{T.moduleId=""}),{deep:!0,immediate:!0});const G=e=>{J.value.setheight()},K=(e,a)=>{"number"==typeof e&&(z.value=e);let l=H.value[0],t=H.value[1];if(!l||""==l||!t||""==t||l.length<10||t.length<10)return c.error("操作时间为必填项，请填写完整再查询！"),!1;if(10!=l.length&&15!=l.length||(l=l.substring(0,10)+" 00"),10!=t.length&&15!=t.length||(t=t.substring(0,10)+" 00"),l>t)return c.error("起始日期范围不能大于结束日期范围，请修改正确再查询！"),!1;if(a){if(P.value&&""===T.loginAccount)return c.error("请输入登录账号！"),T.pageNum=e,!1;if(C.value&&""===T.moduleId)return c.error("请选择系统模块！"),T.pageNum=e,!1}else P.value=!1,C.value=!1;if(!F.value.length)return c.error("操作类型至少选择一个！"),!1;T.pageNum=z.value,T.startDate=l,T.endDate=t,T.operateType=j.$consts.OPTYPE_QUERY,T.cModId=M.moduleId,T.type=F.value.join(),$.value=JSON.parse(JSON.stringify(T)),L()},L=()=>{t(T).then((e=>{E.value=e.data.data.list,O.value=e.data.data.total})).catch((()=>{}))};return s((()=>{let e=j.$dateUtil.currentDate(),t=Number(j.$dateUtil.todayMinutes().split(":")[0])+1;H.value=[e+" 00",e+" "+t],a().then((e=>{B.value=e.data.data})),l().then((e=>{Q.value=e.data.data}))})),(e,a)=>{const l=n("ss-date-time-range"),t=n("el-checkbox"),u=n("el-checkbox-group"),d=n("el-option"),o=n("el-select"),i=n("ss-custom-button"),s=n("ss-condition-area"),c=n("ss-pagination"),k=n("el-table-column"),M=n("ss-table");return r(),m("div",null,[v(s,{onSetConditionFlag:G},{default:p((()=>[b("div",I,[b("div",_,[v(l,{title:"日志时间",defaultValue:H.value,"onUpdate:defaultValue":a[0]||(a[0]=e=>H.value=e),format:"YYYY-MM-DD HH",valueFormat:"YYYY-MM-DD HH"},null,8,["defaultValue"])]),b("div",N,[Y,v(u,{modelValue:F.value,"onUpdate:modelValue":a[1]||(a[1]=e=>F.value=e)},{default:p((()=>[(r(!0),m(f,null,g(R.value,(e=>(r(),h(t,{key:e.key,label:e.id},{default:p((()=>[V(y(e.value),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])]),b("div",w,[b("div",x,[v(t,{modelValue:P.value,"onUpdate:modelValue":a[2]||(a[2]=e=>P.value=e),label:!0,class:"label"},{default:p((()=>[V("登录账号：")])),_:1},8,["modelValue"]),v(o,{modelValue:T.userId,"onUpdate:modelValue":a[3]||(a[3]=e=>T.userId=e),placeholder:"请选择",disabled:!P.value,filterable:""},{default:p((()=>[(r(!0),m(f,null,g(Q.value,(e=>(r(),h(d,{key:e.id,label:e.loginName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])]),b("div",D,[v(t,{modelValue:C.value,"onUpdate:modelValue":a[4]||(a[4]=e=>C.value=e),label:!0,class:"label"},{default:p((()=>[V("系统模块：")])),_:1},8,["modelValue"]),v(o,{modelValue:T.moduleId,"onUpdate:modelValue":a[5]||(a[5]=e=>T.moduleId=e),placeholder:"请选择",disabled:!C.value,filterable:""},{default:p((()=>[(r(!0),m(f,null,g(B.value,(e=>(r(),h(d,{key:e.id,label:e.moduleName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])]),b("div",U,[v(i,{type:"query",onClick:a[6]||(a[6]=e=>K(1,!0))})])])),_:1}),v(c,{total:O.value,pageIndex:z.value,pageSize:A.value,onPageChange:K},null,8,["total","pageIndex","pageSize"]),v(M,{data:E.value,ref_key:"tabPage",ref:J},{default:p((()=>[v(k,{type:"index","min-width":"120",label:"序号"},{default:p((e=>[V(y(20*(T.pageNum-1)+e.$index+1),1)])),_:1}),v(k,{prop:"operType","min-width":"200",label:"操作类型"},{default:p((e=>[V(y(q.value[Number(e.row.operType)]),1)])),_:1}),v(k,{prop:"operUser","min-width":"160",label:"用户名"}),v(k,{prop:"operModule","min-width":"180",label:"模块名称"}),v(k,{prop:"operDate","min-width":"160",label:"记录时间"})])),_:1},8,["data"])])}}};export{k as default};
