var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,r=(e,a)=>{for(var l in a||(a={}))i.call(a,l)&&s(e,l,a[l]);if(t)for(var l of t(a))o.call(a,l)&&s(e,l,a[l]);return e},n=(e,t)=>a(e,l(t));import{p as d,j as p,k as u,l as c}from"./gjdc.b3af9cfa.js";import{d as m,m as b}from"./index.143fdacc.js";import{r as v,j as f,b as h,c as y,e as g,k as N,u as C,U as T,S as W,w as j,f as w,A as k,I as D,Y as O,o as V,d as P}from"./vendor.cc783c3b.js";const x={class:"ss-tree"},U={__name:"profession",setup(e,{expose:a}){let l=v("1"),t=v("全部职业"),i=f([]);const o=async(e,a)=>{if(e.data.leaf)return a([]);let t=e.level,o=e;if(0==t)await m({professionsCode:l.value}).then((e=>{let l=[];return l.push({value:e.data.data.professionCode,label:e.data.data.professionName}),i.value=Object.assign([],e.data.data.childs),a(l)}));else{if(1==t)return i.value.forEach((e=>{e.value=e.professionCode,e.label=e.professionName,e.leaf=e.leaf,e.children=e.childs})),a(i.value);await m({professionsCode:o.data.professionCode||e.data.value}).then((e=>(e.data.data.childs.forEach((e=>{e.value=e.professionCode,e.label=e.professionName,e.leaf=e.leaf,e.children=e.childs})),e.data.data.leaf?(o.isLeaf=!0,a(e.data.data.childs)):a(e.data.data.childs))))}},s=e=>{t.value=e.professionName};return a({treeValue:l,treeName:t}),(e,a)=>{const t=h("el-tree-select");return y(),g("div",x,[N(t,{modelValue:C(l),"onUpdate:modelValue":a[0]||(a[0]=e=>T(l)?l.value=e:l=e),"check-strictly":"",lazy:"",load:o,class:"tree-select-cls",onNodeClick:s},null,8,["modelValue"])])}}},_={key:0,style:{position:"absolute",top:"92px",right:"40px"}},I={style:{margin:"-16px"}},L={__name:"dialogInfo",props:{visible:{type:Boolean,default:!1},detailData:{type:Object,default:{}},detailOtherData:{type:Object,default:{}}},emits:["close"],setup(e,{emit:a}){const l=e,{appContext:t}=O(),i=t.config.globalProperties,o=v([]),s=v(0),u=v(1),c=v(!1),m=f([{label:"序号",minWidth:"60",type:"index"},{label:"姓名",prop:"name",minWidth:"100",overflowTip:!0},{label:"性别",prop:"sex",minWidth:"100"},{label:"出生日期",prop:"birth",minWidth:"100"},{label:"工作单位",prop:"fchildUnitName",minWidth:"100"},{label:"职业分类",prop:"professionName",minWidth:"130",overflowTip:!0},{label:"联系电话",prop:"mobPhone",minWidth:"130",overflowTip:!0},{label:"第1剂次",hasChildrenTitle:!0,list:[{label:"接种日期",prop:"jzrq1",minWidth:"100"},{label:"接种人员",prop:"jzys1",minWidth:"100",overflowTip:!0},{label:"接种单位",prop:"fstationName1",minWidth:"130",overflowTip:!0}]},{label:"第2剂次",hasChildrenTitle:!0,list:[{label:"接种日期",prop:"jzrq2",minWidth:"100"},{label:"接种人员",prop:"jzys2",minWidth:"100",overflowTip:!0},{label:"接种单位",prop:"fstationName2",minWidth:"130",overflowTip:!0}]},{label:"第3剂次",hasChildrenTitle:!0,list:[{label:"接种日期",prop:"jzrq3",minWidth:"100"},{label:"接种人员",prop:"jzys3",minWidth:"100",overflowTip:!0},{label:"接种单位",prop:"fstationName3",minWidth:"130",overflowTip:!0}]},{label:"第4剂次",hasChildrenTitle:!0,list:[{label:"接种日期",prop:"jzrq4",minWidth:"100"},{label:"接种人员",prop:"jzys4",minWidth:"100",overflowTip:!0},{label:"接种单位",prop:"fstationName4",minWidth:"130",overflowTip:!0}]},{label:"第5剂次",hasChildrenTitle:!0,list:[{label:"接种日期",prop:"jzrq5",minWidth:"100"},{label:"接种人员",prop:"jzys5",minWidth:"100"},{label:"接种单位",prop:"fstationName5",minWidth:"130",overflowTip:!0}]}]);W((()=>l.visible),(e=>{e&&(e=>{"number"==typeof e&&(u.value=e);const a=n(r({},l.detailData),{pageIndex:u.value});p(a).then((e=>{if(200===e.data.code)o.value=e.data.data.data.list,s.value=e.data.data.data.total;else if(e.data.popMsg)return secTime.value="",o.value=[],i.$util.showMsg(e.data.popMsg,"error")}))})()}),{deep:!0,immediate:!0});const b=()=>{a("close",!0)},C=()=>{c.value=!0},V=e=>{let a=n(r(r({},l.detailData),l.detailOtherData),{pageIndex:e,areaName:l.detailOtherData.areaName+" "+l.detailData.areaCode.slice(0,10),operateType:i.$consts.OPTYPE_OUTPUT});d(a)},P=()=>{c.value=!1};return(a,l)=>{const t=h("ss-custom-button"),i=h("ss-custom-table"),r=h("el-dialog"),n=h("ss-export-dialog");return y(),g(D,null,[N(r,{title:"按职业分类的新冠病毒疫苗接种信息汇总表",modelValue:e.visible,"onUpdate:modelValue":l[0]||(l[0]=e=>T(visible)?visible.value=e:null),width:"1200","before-close":b,"close-on-click-modal":!1,class:"userManageFormDialog","append-to-body":!0},{default:j((()=>[s.value?(y(),g("div",_,[N(t,{type:"output",onClick:C})])):w("",!0),k("div",I,[N(i,{tableData:o.value,columnList:m,total:s.value},null,8,["tableData","columnList","total"])])])),_:1},8,["modelValue"]),N(n,{onCallback:V,onHandleClose:P,total:s.value,typeStr:"按职业分类的新冠病毒疫苗接种信息汇总表",dialogVisible:c.value},null,8,["total","dialogVisible"])],64)}}},S={class:"condition-row"},q={class:"item"},z=k("span",{class:"label required"},"填报单位：",-1),M={class:"item"},$=k("span",{class:"label required"},"填报日期：",-1),A={class:"item"},E=k("span",{class:"label required"},"数据来源：",-1),F={class:"item"},Y=k("span",{class:"label required"},"职业：",-1),J={class:"condition-row"},B={class:"item"},H=k("span",{class:"label"},"疫苗生产企业：",-1),G={__name:"index",setup(e){const{appContext:a}=O(),l=a.config.globalProperties,t=b(),i=v([]),o=v(0),s=v({code:"",name:"全部"}),d=v(null),p=v(null),m=f([{label:"职业分类",prop:"professionName",minWidth:"240",overflowTip:!0},{label:"摸底总人数",prop:"md",minWidth:"100"},{label:"第一剂",hasChildrenTitle:!0,list:[{label:"累计接种人数",prop:"lj1",minWidth:"100",type:"clickable"},{label:"当日接种人数",prop:"dr1",minWidth:"100",type:"clickable"}]},{label:"第二剂",hasChildrenTitle:!0,list:[{label:"累计接种人数",prop:"lj2",minWidth:"100",type:"clickable"},{label:"当日接种人数",prop:"dr2",minWidth:"100",type:"clickable"}]},{label:"第三剂",hasChildrenTitle:!0,list:[{label:"累计接种人数",prop:"lj3",minWidth:"100",type:"clickable"},{label:"当日接种人数",prop:"dr3",minWidth:"100",type:"clickable"}]},{label:"第四剂",hasChildrenTitle:!0,list:[{label:"累计接种人数",prop:"lj4",minWidth:"100",type:"clickable"},{label:"当日接种人数",prop:"dr4",minWidth:"100",type:"clickable"}]},{label:"第五剂",hasChildrenTitle:!0,list:[{label:"累计接种人数",prop:"lj5",minWidth:"100",type:"clickable"},{label:"当日接种人数",prop:"dr5",minWidth:"100",type:"clickable"}]}]),W=v(null),D=v(null),x=v(null),_=v(!1);let I=f({areaId:t.userInfo.areaId,areaCode:t.userInfo.areaCode,selectAreaLevel:sessionStorage.getItem("currentLevel"),skipValue:String(Number(sessionStorage.getItem("currentLevel"))+1),areaName:t.userInfo.areaName});const G=v([l.$dateUtil.dayAddNum(7),l.$dateUtil.currentDate()]),K=()=>{let e=G.value[0],a=G.value[1];if(!e||!a)return l.$util.showMsg("请选择填报日期范围！","error",5e3,!0);const t={areaCode:I.areaCode,areaLevel:I.selectAreaLevel,startDate:e,endDate:a,fenterNo:p.value.fenterNo,sourceFrom:s.value.code,professionCode:d.value.treeValue};D.value=t,x.value={sourceFromName:s.value.name,fenterName:p.value.fenterName,areaName:I.areaName,professionName:d.value.treeName},u(t).then((e=>{if(200===e.data.code)i.value=e.data.data.data,o.value=e.data.data.sec;else if(e.data.popMsg)return o.value="",i.value=[],l.$util.showMsg(e.data.popMsg,"error")}))},Q=e=>{I=e,I.skipValue=String(Number(I.selectAreaLevel)+1)},R=()=>{if(!D.value||D.value.areaCode!=I.areaCode)return l.$util.showMsg("查询后才可以导出！","error",5e3,!0);let e=JSON.parse(JSON.stringify(D.value));e=n(r(r({},e),x.value),{areaName:x.value.areaName+" "+e.areaCode.slice(0,10)}),e.operateType=l.$consts.OPTYPE_OUTPUT,c(e)},X=(e,a)=>{W.value=n(r({},D.value),{ifSum:"合计"==e.professionName?"1":"0",professionCode:"合计"==e.professionName?d.value.treeValue:e.professionCode,fbactid:a.slice(-1)}),_.value=!0},Z=()=>{_.value=!1};return V((()=>{})),(e,a)=>{const l=h("ss-area-areaTreeStation"),t=h("ss-date-range-new"),r=h("ss-source-data"),n=h("ss-vaccine-vendor"),u=h("ss-custom-button"),c=h("ss-query-bottom"),b=h("ss-condition-area"),v=h("ss-custom-table");return y(),g("div",null,[N(b,null,{default:j((()=>[k("div",S,[k("div",q,[z,N(l,{modelValue:C(I),"onUpdate:modelValue":a[0]||(a[0]=e=>T(I)?I.value=e:I=e),getToLevelNum:5,showSelect:!1,onNodeClick:Q},null,8,["modelValue"])]),k("div",M,[$,N(t,{defaultValue:G.value,"onUpdate:defaultValue":a[1]||(a[1]=e=>G.value=e)},null,8,["defaultValue"])]),k("div",A,[E,N(r,{sourceData:s.value,"onUpdate:modelValue":a[2]||(a[2]=e=>s.value=e)},null,8,["sourceData"])]),k("div",F,[Y,N(U,{ref_key:"selectedProfession",ref:d},null,512)])]),k("div",J,[k("div",B,[H,N(n,{ref_key:"selectedVaccineVendor",ref:p},null,512)])]),N(c,{secTime:o.value},{default:j((()=>[N(u,{type:"query",onClick:K}),N(u,{type:"output",onClick:R})])),_:1},8,["secTime"])])),_:1}),N(v,{tableData:i.value,columnList:m,onOpenDetailDialog:X},null,8,["tableData","columnList"]),_.value?(y(),P(L,{key:0,visible:_.value,onClose:Z,detailData:W.value,detailOtherData:x.value},null,8,["visible","detailData","detailOtherData"])):w("",!0)])}}};export{G as default};
