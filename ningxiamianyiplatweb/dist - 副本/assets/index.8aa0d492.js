import{d as e,a,n as l,o as t}from"./qc.228d3b54.js";import{j as o,r as s,S as i,b as r,c as n,e as u,k as d,w as p,f as m,A as c,U as v,I as b,Y as g,d as f,u as y}from"./vendor.cc783c3b.js";import{m as C}from"./index.143fdacc.js";import{p as N}from"./regex.fcd5bf03.js";const h={key:0,style:{position:"absolute",top:"92px",right:"40px"}},D={style:{margin:"-16px"}},k={__name:"dialogInfo",props:{visible:{type:Boolean,default:!1},detailData:{type:Object,default:{}}},emits:["close"],setup(l,{emit:t}){const f=l,{appContext:y}=g(),C=y.config.globalProperties,N=o([{label:"序号",type:"index"},{label:"接种单位名称",minWidth:"250",overflowTip:!0,formatter:function(e){return e.cityName+"、"+e.countyName+"、"+e.stationName}},{label:"接种单位编码",prop:"stationCode",minWidth:"120",overflowTip:!0},{label:"接种单位地址",prop:"stationAddr",minWidth:"150",overflowTip:!0},{label:"接种单位电话",prop:"linkPhone",minWidth:"140",overflowTip:!0},{label:"接种单位联系人",prop:"linkman",minWidth:"140",overflowTip:!0}]),k=s([]),T=s(0),x=s(1),V=s(20),w=s(!1),S=a=>{"number"==typeof a&&(x.value=a);const l={areaCode:f.detailData.areaCode,overDay:f.detailData.overDay,pageNum:x.value};e(l).then((e=>{k.value=e.data.data.list,T.value=e.data.data.total}))};i((()=>f.visible),(e=>{e&&S()}),{deep:!0,immediate:!0});const I=()=>{t("close",!0)},L=()=>{w.value=!0},P=e=>{let l={areaCode:f.detailData.areaCode,overDay:f.detailData.overDay,areaName:f.detailData.areaName,pageNum:e,operateType:C.$consts.OPTYPE_OUTPUT};a(l)},W=()=>{w.value=!1};return(e,a)=>{const t=r("ss-pagination"),o=r("ss-custom-button"),s=r("ss-custom-table"),i=r("el-dialog"),g=r("ss-export-dialog");return n(),u(b,null,[d(i,{title:"上传数据质量统计明细表",modelValue:l.visible,"onUpdate:modelValue":a[0]||(a[0]=e=>v(visible)?visible.value=e:null),width:"1200","before-close":I,"close-on-click-modal":!1,class:"userManageFormDialog","append-to-body":!0},{default:p((()=>[d(t,{total:T.value,pageIndex:x.value,pageSize:V.value,onPageChange:S},null,8,["total","pageIndex","pageSize"]),T.value?(n(),u("div",h,[d(o,{type:"output",onClick:L})])):m("",!0),c("div",D,[d(s,{tableData:k.value,columnList:N},null,8,["tableData","columnList"])])])),_:1},8,["modelValue"]),d(g,{onCallback:P,onHandleClose:W,total:T.value,typeStr:"上传数据质量统计明细表",dialogVisible:w.value},null,8,["total","dialogVisible"])],64)}}},T={class:"condition-row"},x={class:"item"},V=c("span",{class:"label required"},"选择地区：",-1),w={class:"item"},S=c("span",{class:"ml20 label required"},"超过",-1),I=c("span",{class:"label"},"天未上传",-1),L={__name:"index",setup(e){const a=C(),i=s([]),b=s(0),h=s(!1),D=o({}),L=o([{label:"地区",prop:"areaName",minWidth:"80"},{label:"接种单位数",prop:"unitCount",minWidth:"100"},{label:"上传接种单位数",prop:"uploadCount",minWidth:"100"},{label:"未上传接种单位数",prop:"noUploadCount",minWidth:"100",type:"clickable"},{label:"所占百分比(%)",prop:"per",minWidth:"100"}]),P=s(null),{appContext:W}=g(),U=W.config.globalProperties;let _=o({areaId:a.userInfo.areaId,areaCode:a.userInfo.areaCode,areaName:a.userInfo.areaName,selectAreaLevel:sessionStorage.getItem("currentLevel"),skipValue:String(Number(sessionStorage.getItem("currentLevel"))+1)});const O=s("1"),j=e=>{_=e,_.skipValue=String(Number(_.selectAreaLevel)+1)},q=e=>{_.skipValue=e},$=()=>{if(!O.value)return U.$util.showMsg("天数必填且不能为空！","error");if(!N.test(O.value))return U.$util.showMsg("天数必须是大于0的整数！","error");const e={areaCode:_.areaCode,skipLevel:"5"==_.skipValue?4:_.skipValue,overDay:O.value};P.value=e,l(e).then((e=>{i.value=e.data.data,b.value=e.data.sec}))},A=()=>{if(!P.value||P.value.areaCode!=_.areaCode)return U.$util.showMsg("查询后才可以导出！","error",5e3,!0);let e=JSON.parse(JSON.stringify(P.value));e.areaName=_.areaName,e.operateType=U.$consts.OPTYPE_OUTPUT,t(e)},M=e=>{D.areaCode="合计"==e.areaName?_.areaCode:e.areaCode,D.overDay=O.value,D.areaName="合计"==e.areaName?_.areaName:e.areaName,h.value=!0},Y=()=>{h.value=!1};return(e,a)=>{const l=r("ss-area-areaTreeStation"),t=r("el-input"),o=r("ss-custom-button"),s=r("ss-query-bottom"),g=r("ss-condition-area"),C=r("ss-custom-table");return n(),u("div",null,[d(g,null,{default:p((()=>[c("div",T,[c("div",x,[V,d(l,{modelValue:y(_),"onUpdate:modelValue":a[0]||(a[0]=e=>v(_)?_.value=e:_=e),getToLevelNum:5,onNodeClick:j,showSelect:!0,onSelectClick:q},null,8,["modelValue"])]),c("div",w,[S,d(t,{modelValue:O.value,"onUpdate:modelValue":a[1]||(a[1]=e=>O.value=e),maxlength:"3",min:"0",clearable:"",class:"mr10",style:{"max-width":"100px"}},null,8,["modelValue"]),I])]),d(s,{tipText:"可以点击未上传接种单位数字查看明细",secTime:b.value},{default:p((()=>[d(o,{type:"query",onClick:$}),d(o,{type:"output",onClick:A})])),_:1},8,["secTime"])])),_:1}),d(C,{tableData:i.value,columnList:L,onOpenDetailDialog:M,total:0},null,8,["tableData","columnList"]),h.value?(n(),f(k,{key:0,visible:h.value,onClose:Y,detailData:D},null,8,["visible","detailData"])):m("",!0)])}}};export{L as default};
