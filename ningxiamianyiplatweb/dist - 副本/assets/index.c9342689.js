import{I as e,J as a,K as l,L as t}from"./gjdc.b3af9cfa.js";import{r as s,j as o,S as r,b as i,c as d,e as u,k as n,w as p,f as c,A as m,U as v,I as g,Y as b,d as h,u as y,l as f,B as C}from"./vendor.cc783c3b.js";import{m as T}from"./index.143fdacc.js";const D={key:0,style:{position:"absolute",top:"92px",right:"40px"}},N={style:{margin:"-16px"}},w={__name:"dialogInfo",props:{visible:{type:Boolean,default:!1},searchData:{type:Object,default:{}}},emits:["close"],setup(l,{emit:t}){const h=l,{appContext:y}=b(),f=y.config.globalProperties,C=s([]),T=s(0),w=s(1),S=o([{label:"序号",minWidth:"60",type:"index"},{label:"地市编码",prop:"cityCode",minWidth:"100"},{label:"地市名称",prop:"cityName",minWidth:"100"},{label:"县区编码",prop:"countyCode",minWidth:"100"},{label:"县区名称",prop:"countyName",minWidth:"100"},{label:"单位编码",prop:"fstationCode",minWidth:"100"},{label:"单位名称",prop:"fstationName",minWidth:"100"},{label:"受种者编码",prop:"fchildno",minWidth:"130"},{label:"姓名",prop:"name"},{label:"性别",prop:"sex",type:"01"==h.searchData.dataType?"judge":"null"},{label:"出生日期",prop:"birth",type:"01"==h.searchData.dataType?"judge":"null"},{label:"身份证件号码",prop:"cid",type:"01"==h.searchData.dataType?"judge":"null"},{label:"疫苗剂次",prop:"fbactid",type:"02"==h.searchData.dataType?"judge":"null"},{label:"接种日期",prop:"jzrq",type:"02"==h.searchData.dataType?"judge":"null"},{label:"错误描述（message）",prop:"errorDesc",minWidth:"180"},{label:"数据不合格类型",prop:"messageType",minWidth:"150"}]),k=s(null),x=a=>{"number"==typeof a&&(w.value=a);const l={areaCode:h.searchData.areaCode,areaId:h.searchData.areaId,areaLevel:h.searchData.areaLevel,areaName:h.searchData.areaName,endTime:h.searchData.endTime,dataType:h.searchData.dataType,startTime:h.searchData.startTime,childCount:h.searchData.childCount,messageType:h.searchData.messageType,pageNum:w.value,pageSize:f.$consts.PAGE_SIZE};e(l).then((e=>{200===e.data.code&&(C.value=e.data.data.list,T.value=e.data.data.total)}))};r((()=>h.visible),(e=>{e&&x()}),{deep:!0,immediate:!0});const V=()=>{t("close",!0)},I=()=>h.searchData&&h.searchData.areaCode==areaTreeValue.areaCode?C.value&&0==C.value.length?f.$util.showMsg("暂无需要导出的数据！","error",5e3,!0):void(k.value=!0):f.$util.showMsg("查询后才可以导出！","error",5e3,!0),_=()=>{let e=JSON.parse(JSON.stringify(searchData.value));e.operateType=f.$consts.OPTYPE_OUTPUT,a(e)},j=()=>{k.value=!1};return(e,a)=>{const t=i("ss-pagination"),s=i("ss-custom-button"),o=i("ss-custom-table"),r=i("el-dialog"),b=i("ss-export-dialog");return d(),u(g,null,[n(r,{title:"国家数据不合格未上传统计表详情",modelValue:l.visible,"onUpdate:modelValue":a[0]||(a[0]=e=>v(visible)?visible.value=e:null),width:"1200","before-close":V,"close-on-click-modal":!1,class:"customDialog","append-to-body":!0},{default:p((()=>[n(t,{total:T.value,pageIndex:w.value,pageSize:e.pageSize,onPageChange:x},null,8,["total","pageIndex","pageSize"]),T.value?(d(),u("div",D,[n(s,{type:"output",onClick:I})])):c("",!0),m("div",N,[n(o,{tableData:C.value,columnList:S},null,8,["tableData","columnList"])])])),_:1},8,["modelValue"]),n(b,{onCallback:_,onHandleClose:j,total:T.value,typeStr:"国家数据不合格未上传统计",dialogVisible:k.value},null,8,["total","dialogVisible"])],64)}}};const S={class:"nopack"},k={class:"condition-row"},x={class:"item"},V=m("span",{class:"required label"},"上传日期：",-1),I={class:"item"},_=m("span",{class:"required label"},"选择地区：",-1),j={class:"item"},U=m("span",{class:"label"},"数据类型：",-1),$={key:0},L=["onClick"],P={__name:"index",setup(e){const{appContext:a}=b(),r=a.config.globalProperties,g=T(),D=s([]),N=s("01"),P=s(0),W=s(0),O=s([r.$dateUtil.dayAddNum(1),r.$dateUtil.dayAddNum(1)]);let M=o({areaId:g.userInfo.areaId,areaCode:g.userInfo.areaCode,selectAreaLevel:sessionStorage.getItem("currentLevel"),areaName:g.userInfo.areaName});const z=s(!1),A=s(null),q=s(!1),J=s(null),E=()=>{let e=O.value[0],a=O.value[1];if(!e||!a)return r.$util.showMsg("请选择上传日期范围！","error",5e3,!0);const l={areaCode:M.areaCode,areaId:M.areaId,areaLevel:M.selectAreaLevel,areaName:M.areaName,endTime:a,dataType:N.value,startTime:e};J.value=l,t(l).then((e=>{if(e.data.popMsg)return D.value=[],P.value="",W.value=0,r.$util.showMsg(e.data.popMsg,"error");200===e.data.code&&(D.value=e.data.data.list,W.value=e.data.data.total,P.value=e.data.sec)}))},Y=e=>{M=e},B=()=>J.value&&J.value.areaCode==M.areaCode?D.value&&0==D.value.length?r.$util.showMsg("暂无需要导出的数据！","error",5e3,!0):void(z.value=!0):r.$util.showMsg("查询后才可以导出！","error",5e3,!0),H=()=>{let e=JSON.parse(JSON.stringify(J.value));e.areaName=e.areaName+" "+e.areaCode.slice(0,10),e.operateType=r.$consts.OPTYPE_OUTPUT,l(e)},G=()=>{z.value=!1},K=()=>{q.value=!1};return(e,a)=>{const l=i("ss-date-range-new"),t=i("ss-area-areaTreeStation"),s=i("el-radio"),o=i("el-radio-group"),r=i("ss-custom-button"),g=i("ss-query-bottom"),b=i("ss-condition-area"),T=i("el-table-column"),R=i("ss-table"),Z=i("ss-export-dialog");return d(),u("div",S,[n(b,null,{default:p((()=>[m("div",k,[m("div",x,[V,n(l,{ref_key:"daterangeRef",ref:A,defaultValue:O.value,"onUpdate:defaultValue":a[0]||(a[0]=e=>O.value=e),rangeName:"weeks"},null,8,["defaultValue"])]),m("div",I,[_,n(t,{ref:"areaTreeStation",modelValue:y(M),"onUpdate:modelValue":a[1]||(a[1]=e=>v(M)?M.value=e:M=e),getToLevelNum:5,showSelect:!1,onNodeClick:Y},null,8,["modelValue"])]),m("div",j,[U,n(o,{modelValue:N.value,"onUpdate:modelValue":a[2]||(a[2]=e=>N.value=e),class:"ml-4"},{default:p((()=>[n(s,{label:"01",size:"large"},{default:p((()=>[f("基本信息")])),_:1}),n(s,{label:"02",size:"large"},{default:p((()=>[f("接种记录")])),_:1})])),_:1},8,["modelValue"])])]),n(g,{tipText:"基本信息错误按归属单位统计；接种记录错误按接种单位统计；已撤销接种单位按归属单位统计；卡介苗、乙肝1按归属单位统计。",secTime:P.value},{default:p((()=>[n(r,{type:"query",onClick:E}),n(r,{type:"output",onClick:B})])),_:1},8,["secTime"])])),_:1}),n(R,{data:D.value,headerCellStyle:{"text-align":"center"},cellStyle:{"text-align":"center"}},{default:p((()=>[n(T,{label:"不合格类型",prop:"messageType"}),n(T,{"min-width":"60",label:"数量"},{default:p((e=>[0==e.row.totalCount?(d(),u("span",$,C(e.row.totalCount),1)):(d(),u("span",{key:1,onClick:a=>{return l=e.row.messageType,t=e.row.totalCount,J.messageType=l,J.childCount=t,void(q.value=!0);var l,t},class:"pointer"},C(e.row.totalCount),9,L))])),_:1})])),_:1},8,["data"]),q.value?(d(),h(w,{key:0,visible:q.value,onClose:K,searchData:J.value},null,8,["visible","searchData"])):c("",!0),n(Z,{onCallback:H,onHandleClose:G,total:W.value,typeStr:"国家数据不合格未上传统计",dialogVisible:z.value},null,8,["total","dialogVisible"])])}}};export{P as default};
